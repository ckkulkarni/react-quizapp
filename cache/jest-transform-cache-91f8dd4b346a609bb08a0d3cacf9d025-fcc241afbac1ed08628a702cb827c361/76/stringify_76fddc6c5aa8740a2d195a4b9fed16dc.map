{"version":3,"names":["__spreadArray","to","from","pack","arguments","length","i","l","ar","Array","prototype","slice","call","concat","Object","defineProperty","exports","value","stringify","types_1","require","attribValChars","pseudoValChars","charsToEscapeInAttributeValue","Set","map","c","charCodeAt","charsToEscapeInPseudoValue","charsToEscapeInName","selector","token","stringifyToken","join","index","arr","type","SelectorType","Child","Parent","Sibling","Adjacent","Descendant","ColumnCombinator","Universal","namespace","getNamespace","Tag","getNamespacedName","PseudoElement","escapeName","name","data","Pseudo","Attribute","action","AttributeAction","Equals","ignoreCase","Element","name_1","Exists","getActionValue","Start","End","Any","Not","Hyphen","Error","str","charsToEscape","lastIdx","ret","has","charAt"],"sources":["stringify.js"],"sourcesContent":["\"use strict\";\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.stringify = void 0;\nvar types_1 = require(\"./types\");\nvar attribValChars = [\"\\\\\", '\"'];\nvar pseudoValChars = __spreadArray(__spreadArray([], attribValChars, true), [\"(\", \")\"], false);\nvar charsToEscapeInAttributeValue = new Set(attribValChars.map(function (c) { return c.charCodeAt(0); }));\nvar charsToEscapeInPseudoValue = new Set(pseudoValChars.map(function (c) { return c.charCodeAt(0); }));\nvar charsToEscapeInName = new Set(__spreadArray(__spreadArray([], pseudoValChars, true), [\n    \"~\",\n    \"^\",\n    \"$\",\n    \"*\",\n    \"+\",\n    \"!\",\n    \"|\",\n    \":\",\n    \"[\",\n    \"]\",\n    \" \",\n    \".\",\n], false).map(function (c) { return c.charCodeAt(0); }));\n/**\n * Turns `selector` back into a string.\n *\n * @param selector Selector to stringify.\n */\nfunction stringify(selector) {\n    return selector\n        .map(function (token) { return token.map(stringifyToken).join(\"\"); })\n        .join(\", \");\n}\nexports.stringify = stringify;\nfunction stringifyToken(token, index, arr) {\n    switch (token.type) {\n        // Simple types\n        case types_1.SelectorType.Child:\n            return index === 0 ? \"> \" : \" > \";\n        case types_1.SelectorType.Parent:\n            return index === 0 ? \"< \" : \" < \";\n        case types_1.SelectorType.Sibling:\n            return index === 0 ? \"~ \" : \" ~ \";\n        case types_1.SelectorType.Adjacent:\n            return index === 0 ? \"+ \" : \" + \";\n        case types_1.SelectorType.Descendant:\n            return \" \";\n        case types_1.SelectorType.ColumnCombinator:\n            return index === 0 ? \"|| \" : \" || \";\n        case types_1.SelectorType.Universal:\n            // Return an empty string if the selector isn't needed.\n            return token.namespace === \"*\" &&\n                index + 1 < arr.length &&\n                \"name\" in arr[index + 1]\n                ? \"\"\n                : \"\".concat(getNamespace(token.namespace), \"*\");\n        case types_1.SelectorType.Tag:\n            return getNamespacedName(token);\n        case types_1.SelectorType.PseudoElement:\n            return \"::\".concat(escapeName(token.name, charsToEscapeInName)).concat(token.data === null\n                ? \"\"\n                : \"(\".concat(escapeName(token.data, charsToEscapeInPseudoValue), \")\"));\n        case types_1.SelectorType.Pseudo:\n            return \":\".concat(escapeName(token.name, charsToEscapeInName)).concat(token.data === null\n                ? \"\"\n                : \"(\".concat(typeof token.data === \"string\"\n                    ? escapeName(token.data, charsToEscapeInPseudoValue)\n                    : stringify(token.data), \")\"));\n        case types_1.SelectorType.Attribute: {\n            if (token.name === \"id\" &&\n                token.action === types_1.AttributeAction.Equals &&\n                token.ignoreCase === \"quirks\" &&\n                !token.namespace) {\n                return \"#\".concat(escapeName(token.value, charsToEscapeInName));\n            }\n            if (token.name === \"class\" &&\n                token.action === types_1.AttributeAction.Element &&\n                token.ignoreCase === \"quirks\" &&\n                !token.namespace) {\n                return \".\".concat(escapeName(token.value, charsToEscapeInName));\n            }\n            var name_1 = getNamespacedName(token);\n            if (token.action === types_1.AttributeAction.Exists) {\n                return \"[\".concat(name_1, \"]\");\n            }\n            return \"[\".concat(name_1).concat(getActionValue(token.action), \"=\\\"\").concat(escapeName(token.value, charsToEscapeInAttributeValue), \"\\\"\").concat(token.ignoreCase === null ? \"\" : token.ignoreCase ? \" i\" : \" s\", \"]\");\n        }\n    }\n}\nfunction getActionValue(action) {\n    switch (action) {\n        case types_1.AttributeAction.Equals:\n            return \"\";\n        case types_1.AttributeAction.Element:\n            return \"~\";\n        case types_1.AttributeAction.Start:\n            return \"^\";\n        case types_1.AttributeAction.End:\n            return \"$\";\n        case types_1.AttributeAction.Any:\n            return \"*\";\n        case types_1.AttributeAction.Not:\n            return \"!\";\n        case types_1.AttributeAction.Hyphen:\n            return \"|\";\n        case types_1.AttributeAction.Exists:\n            throw new Error(\"Shouldn't be here\");\n    }\n}\nfunction getNamespacedName(token) {\n    return \"\".concat(getNamespace(token.namespace)).concat(escapeName(token.name, charsToEscapeInName));\n}\nfunction getNamespace(namespace) {\n    return namespace !== null\n        ? \"\".concat(namespace === \"*\"\n            ? \"*\"\n            : escapeName(namespace, charsToEscapeInName), \"|\")\n        : \"\";\n}\nfunction escapeName(str, charsToEscape) {\n    var lastIdx = 0;\n    var ret = \"\";\n    for (var i = 0; i < str.length; i++) {\n        if (charsToEscape.has(str.charCodeAt(i))) {\n            ret += \"\".concat(str.slice(lastIdx, i), \"\\\\\").concat(str.charAt(i));\n            lastIdx = i + 1;\n        }\n    }\n    return ret.length > 0 ? ret + str.slice(lastIdx) : str;\n}\n"],"mappings":"AAAA,YAAY;;AACZ,IAAIA,aAAa,GAAI,UAAQ,SAAKA,aAAa,IAAK,UAAUC,EAAE,EAAEC,IAAI,EAAEC,IAAI,EAAE;EAC1E,IAAIA,IAAI,IAAIC,SAAS,CAACC,MAAM,KAAK,CAAC,EAAE,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEC,CAAC,GAAGL,IAAI,CAACG,MAAM,EAAEG,EAAE,EAAEF,CAAC,GAAGC,CAAC,EAAED,CAAC,EAAE,EAAE;IACjF,IAAIE,EAAE,IAAI,EAAEF,CAAC,IAAIJ,IAAI,CAAC,EAAE;MACpB,IAAI,CAACM,EAAE,EAAEA,EAAE,GAAGC,KAAK,CAACC,SAAS,CAACC,KAAK,CAACC,IAAI,CAACV,IAAI,EAAE,CAAC,EAAEI,CAAC,CAAC;MACpDE,EAAE,CAACF,CAAC,CAAC,GAAGJ,IAAI,CAACI,CAAC,CAAC;IACnB;EACJ;EACA,OAAOL,EAAE,CAACY,MAAM,CAACL,EAAE,IAAIC,KAAK,CAACC,SAAS,CAACC,KAAK,CAACC,IAAI,CAACV,IAAI,CAAC,CAAC;AAC5D,CAAC;AACDY,MAAM,CAACC,cAAc,CAACC,OAAO,EAAE,YAAY,EAAE;EAAEC,KAAK,EAAE;AAAK,CAAC,CAAC;AAC7DD,OAAO,CAACE,SAAS,GAAG,KAAK,CAAC;AAC1B,IAAIC,OAAO,GAAGC,OAAO,CAAC,SAAS,CAAC;AAChC,IAAIC,cAAc,GAAG,CAAC,IAAI,EAAE,GAAG,CAAC;AAChC,IAAIC,cAAc,GAAGtB,aAAa,CAACA,aAAa,CAAC,EAAE,EAAEqB,cAAc,EAAE,IAAI,CAAC,EAAE,CAAC,GAAG,EAAE,GAAG,CAAC,EAAE,KAAK,CAAC;AAC9F,IAAIE,6BAA6B,GAAG,IAAIC,GAAG,CAACH,cAAc,CAACI,GAAG,CAAC,UAAUC,CAAC,EAAE;EAAE,OAAOA,CAAC,CAACC,UAAU,CAAC,CAAC,CAAC;AAAE,CAAC,CAAC,CAAC;AACzG,IAAIC,0BAA0B,GAAG,IAAIJ,GAAG,CAACF,cAAc,CAACG,GAAG,CAAC,UAAUC,CAAC,EAAE;EAAE,OAAOA,CAAC,CAACC,UAAU,CAAC,CAAC,CAAC;AAAE,CAAC,CAAC,CAAC;AACtG,IAAIE,mBAAmB,GAAG,IAAIL,GAAG,CAACxB,aAAa,CAACA,aAAa,CAAC,EAAE,EAAEsB,cAAc,EAAE,IAAI,CAAC,EAAE,CACrF,GAAG,EACH,GAAG,EACH,GAAG,EACH,GAAG,EACH,GAAG,EACH,GAAG,EACH,GAAG,EACH,GAAG,EACH,GAAG,EACH,GAAG,EACH,GAAG,EACH,GAAG,CACN,EAAE,KAAK,CAAC,CAACG,GAAG,CAAC,UAAUC,CAAC,EAAE;EAAE,OAAOA,CAAC,CAACC,UAAU,CAAC,CAAC,CAAC;AAAE,CAAC,CAAC,CAAC;AACxD;AACA;AACA;AACA;AACA;AACA,SAAST,SAASA,CAACY,QAAQ,EAAE;EACzB,OAAOA,QAAQ,CACVL,GAAG,CAAC,UAAUM,KAAK,EAAE;IAAE,OAAOA,KAAK,CAACN,GAAG,CAACO,cAAc,CAAC,CAACC,IAAI,CAAC,EAAE,CAAC;EAAE,CAAC,CAAC,CACpEA,IAAI,CAAC,IAAI,CAAC;AACnB;AACAjB,OAAO,CAACE,SAAS,GAAGA,SAAS;AAC7B,SAASc,cAAcA,CAACD,KAAK,EAAEG,KAAK,EAAEC,GAAG,EAAE;EACvC,QAAQJ,KAAK,CAACK,IAAI;IACd;IACA,KAAKjB,OAAO,CAACkB,YAAY,CAACC,KAAK;MAC3B,OAAOJ,KAAK,KAAK,CAAC,GAAG,IAAI,GAAG,KAAK;IACrC,KAAKf,OAAO,CAACkB,YAAY,CAACE,MAAM;MAC5B,OAAOL,KAAK,KAAK,CAAC,GAAG,IAAI,GAAG,KAAK;IACrC,KAAKf,OAAO,CAACkB,YAAY,CAACG,OAAO;MAC7B,OAAON,KAAK,KAAK,CAAC,GAAG,IAAI,GAAG,KAAK;IACrC,KAAKf,OAAO,CAACkB,YAAY,CAACI,QAAQ;MAC9B,OAAOP,KAAK,KAAK,CAAC,GAAG,IAAI,GAAG,KAAK;IACrC,KAAKf,OAAO,CAACkB,YAAY,CAACK,UAAU;MAChC,OAAO,GAAG;IACd,KAAKvB,OAAO,CAACkB,YAAY,CAACM,gBAAgB;MACtC,OAAOT,KAAK,KAAK,CAAC,GAAG,KAAK,GAAG,MAAM;IACvC,KAAKf,OAAO,CAACkB,YAAY,CAACO,SAAS;MAC/B;MACA,OAAOb,KAAK,CAACc,SAAS,KAAK,GAAG,IAC1BX,KAAK,GAAG,CAAC,GAAGC,GAAG,CAAC9B,MAAM,IACtB,MAAM,IAAI8B,GAAG,CAACD,KAAK,GAAG,CAAC,CAAC,GACtB,EAAE,GACF,EAAE,CAACrB,MAAM,CAACiC,YAAY,CAACf,KAAK,CAACc,SAAS,CAAC,EAAE,GAAG,CAAC;IACvD,KAAK1B,OAAO,CAACkB,YAAY,CAACU,GAAG;MACzB,OAAOC,iBAAiB,CAACjB,KAAK,CAAC;IACnC,KAAKZ,OAAO,CAACkB,YAAY,CAACY,aAAa;MACnC,OAAO,IAAI,CAACpC,MAAM,CAACqC,UAAU,CAACnB,KAAK,CAACoB,IAAI,EAAEtB,mBAAmB,CAAC,CAAC,CAAChB,MAAM,CAACkB,KAAK,CAACqB,IAAI,KAAK,IAAI,GACpF,EAAE,GACF,GAAG,CAACvC,MAAM,CAACqC,UAAU,CAACnB,KAAK,CAACqB,IAAI,EAAExB,0BAA0B,CAAC,EAAE,GAAG,CAAC,CAAC;IAC9E,KAAKT,OAAO,CAACkB,YAAY,CAACgB,MAAM;MAC5B,OAAO,GAAG,CAACxC,MAAM,CAACqC,UAAU,CAACnB,KAAK,CAACoB,IAAI,EAAEtB,mBAAmB,CAAC,CAAC,CAAChB,MAAM,CAACkB,KAAK,CAACqB,IAAI,KAAK,IAAI,GACnF,EAAE,GACF,GAAG,CAACvC,MAAM,CAAC,OAAOkB,KAAK,CAACqB,IAAI,KAAK,QAAQ,GACrCF,UAAU,CAACnB,KAAK,CAACqB,IAAI,EAAExB,0BAA0B,CAAC,GAClDV,SAAS,CAACa,KAAK,CAACqB,IAAI,CAAC,EAAE,GAAG,CAAC,CAAC;IAC1C,KAAKjC,OAAO,CAACkB,YAAY,CAACiB,SAAS;MAAE;QACjC,IAAIvB,KAAK,CAACoB,IAAI,KAAK,IAAI,IACnBpB,KAAK,CAACwB,MAAM,KAAKpC,OAAO,CAACqC,eAAe,CAACC,MAAM,IAC/C1B,KAAK,CAAC2B,UAAU,KAAK,QAAQ,IAC7B,CAAC3B,KAAK,CAACc,SAAS,EAAE;UAClB,OAAO,GAAG,CAAChC,MAAM,CAACqC,UAAU,CAACnB,KAAK,CAACd,KAAK,EAAEY,mBAAmB,CAAC,CAAC;QACnE;QACA,IAAIE,KAAK,CAACoB,IAAI,KAAK,OAAO,IACtBpB,KAAK,CAACwB,MAAM,KAAKpC,OAAO,CAACqC,eAAe,CAACG,OAAO,IAChD5B,KAAK,CAAC2B,UAAU,KAAK,QAAQ,IAC7B,CAAC3B,KAAK,CAACc,SAAS,EAAE;UAClB,OAAO,GAAG,CAAChC,MAAM,CAACqC,UAAU,CAACnB,KAAK,CAACd,KAAK,EAAEY,mBAAmB,CAAC,CAAC;QACnE;QACA,IAAI+B,MAAM,GAAGZ,iBAAiB,CAACjB,KAAK,CAAC;QACrC,IAAIA,KAAK,CAACwB,MAAM,KAAKpC,OAAO,CAACqC,eAAe,CAACK,MAAM,EAAE;UACjD,OAAO,GAAG,CAAChD,MAAM,CAAC+C,MAAM,EAAE,GAAG,CAAC;QAClC;QACA,OAAO,GAAG,CAAC/C,MAAM,CAAC+C,MAAM,CAAC,CAAC/C,MAAM,CAACiD,cAAc,CAAC/B,KAAK,CAACwB,MAAM,CAAC,EAAE,KAAK,CAAC,CAAC1C,MAAM,CAACqC,UAAU,CAACnB,KAAK,CAACd,KAAK,EAAEM,6BAA6B,CAAC,EAAE,IAAI,CAAC,CAACV,MAAM,CAACkB,KAAK,CAAC2B,UAAU,KAAK,IAAI,GAAG,EAAE,GAAG3B,KAAK,CAAC2B,UAAU,GAAG,IAAI,GAAG,IAAI,EAAE,GAAG,CAAC;MAC3N;EAAC;AAET;AACA,SAASI,cAAcA,CAACP,MAAM,EAAE;EAC5B,QAAQA,MAAM;IACV,KAAKpC,OAAO,CAACqC,eAAe,CAACC,MAAM;MAC/B,OAAO,EAAE;IACb,KAAKtC,OAAO,CAACqC,eAAe,CAACG,OAAO;MAChC,OAAO,GAAG;IACd,KAAKxC,OAAO,CAACqC,eAAe,CAACO,KAAK;MAC9B,OAAO,GAAG;IACd,KAAK5C,OAAO,CAACqC,eAAe,CAACQ,GAAG;MAC5B,OAAO,GAAG;IACd,KAAK7C,OAAO,CAACqC,eAAe,CAACS,GAAG;MAC5B,OAAO,GAAG;IACd,KAAK9C,OAAO,CAACqC,eAAe,CAACU,GAAG;MAC5B,OAAO,GAAG;IACd,KAAK/C,OAAO,CAACqC,eAAe,CAACW,MAAM;MAC/B,OAAO,GAAG;IACd,KAAKhD,OAAO,CAACqC,eAAe,CAACK,MAAM;MAC/B,MAAM,IAAIO,KAAK,CAAC,mBAAmB,CAAC;EAAC;AAEjD;AACA,SAASpB,iBAAiBA,CAACjB,KAAK,EAAE;EAC9B,OAAO,EAAE,CAAClB,MAAM,CAACiC,YAAY,CAACf,KAAK,CAACc,SAAS,CAAC,CAAC,CAAChC,MAAM,CAACqC,UAAU,CAACnB,KAAK,CAACoB,IAAI,EAAEtB,mBAAmB,CAAC,CAAC;AACvG;AACA,SAASiB,YAAYA,CAACD,SAAS,EAAE;EAC7B,OAAOA,SAAS,KAAK,IAAI,GACnB,EAAE,CAAChC,MAAM,CAACgC,SAAS,KAAK,GAAG,GACvB,GAAG,GACHK,UAAU,CAACL,SAAS,EAAEhB,mBAAmB,CAAC,EAAE,GAAG,CAAC,GACpD,EAAE;AACZ;AACA,SAASqB,UAAUA,CAACmB,GAAG,EAAEC,aAAa,EAAE;EACpC,IAAIC,OAAO,GAAG,CAAC;EACf,IAAIC,GAAG,GAAG,EAAE;EACZ,KAAK,IAAIlE,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG+D,GAAG,CAAChE,MAAM,EAAEC,CAAC,EAAE,EAAE;IACjC,IAAIgE,aAAa,CAACG,GAAG,CAACJ,GAAG,CAAC1C,UAAU,CAACrB,CAAC,CAAC,CAAC,EAAE;MACtCkE,GAAG,IAAI,EAAE,CAAC3D,MAAM,CAACwD,GAAG,CAAC1D,KAAK,CAAC4D,OAAO,EAAEjE,CAAC,CAAC,EAAE,IAAI,CAAC,CAACO,MAAM,CAACwD,GAAG,CAACK,MAAM,CAACpE,CAAC,CAAC,CAAC;MACnEiE,OAAO,GAAGjE,CAAC,GAAG,CAAC;IACnB;EACJ;EACA,OAAOkE,GAAG,CAACnE,MAAM,GAAG,CAAC,GAAGmE,GAAG,GAAGH,GAAG,CAAC1D,KAAK,CAAC4D,OAAO,CAAC,GAAGF,GAAG;AAC1D"}
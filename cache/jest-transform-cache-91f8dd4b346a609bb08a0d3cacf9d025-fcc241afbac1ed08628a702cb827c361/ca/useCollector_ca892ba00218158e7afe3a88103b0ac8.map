{"version":3,"names":["_fastDeepEqual","_interopRequireDefault","require","_react","_useIsomorphicLayoutEffect","obj","__esModule","default","useCollector","monitor","collect","onUpdate","collected","setCollected","useState","updateCollected","useCallback","nextValue","equal","useIsomorphicLayoutEffect"],"sources":["../../src/hooks/useCollector.ts"],"sourcesContent":["import equal from 'fast-deep-equal'\nimport { useCallback, useState } from 'react'\n\nimport { useIsomorphicLayoutEffect } from './useIsomorphicLayoutEffect.js'\n\n/**\n *\n * @param monitor The monitor to collect state from\n * @param collect The collecting function\n * @param onUpdate A method to invoke when updates occur\n */\nexport function useCollector<T, S>(\n\tmonitor: T,\n\tcollect: (monitor: T) => S,\n\tonUpdate?: () => void,\n): [S, () => void] {\n\tconst [collected, setCollected] = useState(() => collect(monitor))\n\n\tconst updateCollected = useCallback(() => {\n\t\tconst nextValue = collect(monitor)\n\t\t// This needs to be a deep-equality check because some monitor-collected values\n\t\t// include XYCoord objects that may be equivalent, but do not have instance equality.\n\t\tif (!equal(collected, nextValue)) {\n\t\t\tsetCollected(nextValue)\n\t\t\tif (onUpdate) {\n\t\t\t\tonUpdate()\n\t\t\t}\n\t\t}\n\t}, [collected, monitor, onUpdate])\n\n\t// update the collected properties after react renders.\n\t// Note that the \"Dustbin Stress Test\" fails if this is not\n\t// done when the component updates\n\tuseIsomorphicLayoutEffect(updateCollected)\n\n\treturn [collected, updateCollected]\n}\n"],"mappings":";;;;;;AAAA,IAAAA,cAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,MAAA,GAAAD,OAAA;AAEA,IAAAE,0BAAA,GAAAF,OAAA;AAA0E,SAAAD,uBAAAI,GAAA,WAAAA,GAAA,IAAAA,GAAA,CAAAC,UAAA,GAAAD,GAAA,KAAAE,OAAA,EAAAF,GAAA;AAE1E;;;;;;AAMO,SAASG,YAAYA,CAC3BC,OAAU,EACVC,OAA0B,EAC1BC,QAAqB,EACH;EAClB,MAAM,CAACC,SAAS,EAAEC,YAAY,CAAC,GAAG,IAAAC,eAAQ,EAAC,MAAMJ,OAAO,CAACD,OAAO,CAAC,CAAC;EAElE,MAAMM,eAAe,GAAG,IAAAC,kBAAW,EAAC,MAAM;IACzC,MAAMC,SAAS,GAAGP,OAAO,CAACD,OAAO,CAAC;IAClC;IACA;IACA,IAAI,CAAC,IAAAS,sBAAK,EAACN,SAAS,EAAEK,SAAS,CAAC,EAAE;MACjCJ,YAAY,CAACI,SAAS,CAAC;MACvB,IAAIN,QAAQ,EAAE;QACbA,QAAQ,EAAE;;;GAGZ,EAAE,CAACC,SAAS,EAAEH,OAAO,EAAEE,QAAQ,CAAC,CAAC;EAElC;EACA;EACA;EACA,IAAAQ,oDAAyB,EAACJ,eAAe,CAAC;EAE1C,OAAO,CAACH,SAAS,EAAEG,eAAe,CAAC"}
{"version":3,"names":["getAdapter","makeOptions","isCustomComponent","isCustomComponentElement","propsOfNode","typeOfNode","nodeHasType","nodeMatches","nodeEqual","containsChildrenSubArray","childrenToSimplifiedArray","isReactElementAlike","withSetStateAllowed","AND","displayNameOfNode","sym","privateSet","cloneElement","spyMethod","isEmptyValue","renderedDive","loadCheerioRoot","_lodash","require","_objectIs","_object3","_functionPrototype","_has","_arrayPrototype","_stringPrototype","_cheerio","_utils","_configuration","_RSTTraversal","_getAdapter","_validateAdapter","ITERATOR_SYMBOL","exports","Symbol","iterator","options","arguments","length","undefined","console","warn","_getAdapter2","validateMountOptions","attachTo","hydrateIn","TypeError","_get","get","configAttachTo","configHydrateIn","config","_objectWithoutProperties","finalAttachTo","finalHydrateIn","mountTargets","_object2","component","adapter","_validateAdapter2","inst","isValidElement","type","node","_object4","props","filter","_ref","_ref2","_slicedToArray","value","reduce","acc","_ref3","_ref4","key","_defineProperty","displayName","_functionPrototype2","name","internalChildrenCompare","a","b","lenComp","isLoose","nodeCompare","Array","isArray","flatA","_arrayPrototype2","Infinity","flatB","i","childrenMatch","childrenEqual","removeNullaryReducer","_ref5","_ref6","addition","internalNodeCompare","left","right","leftKeys","Object","keys","prop","_typeof","_lodash2","leftHasChildren","rightHasChildren","childCompare","children","isTextualNode","rightKeys","_objectIs2","match","subArray","childrenOfNode","checker","_","arraysEqual","slice","some","every","el","childrenToArray","result","push","forEach","nodeChildren","childrenArray","simplifiedArray","child","previousChild","pop","map","x","_stringPrototype2","arg","fn","cleanup","global","document","fns","fnsReversed","reverse","s","String","obj","defineProperty","enumerable","writable","createElement","instance","methodName","getStub","lastReturnValue","originalMethod","hasOwn","_has2","descriptor","getOwnPropertyDescriptor","configurable","spied","_len","args","_key","apply","restore","getLastReturnValue","renderedValue","nodes","concat","n","rendered","html","_cheerio2","root","isHtml","load"],"sources":["../src/Utils.js"],"sourcesContent":["/* eslint no-use-before-define: 0 */\nimport isEqual from 'lodash.isequal';\nimport is from 'object-is';\nimport entries from 'object.entries';\nimport functionName from 'function.prototype.name';\nimport has from 'has';\nimport flat from 'array.prototype.flat';\nimport trim from 'string.prototype.trim';\nimport cheerio from 'cheerio';\nimport { isHtml } from 'cheerio/lib/utils';\n\nimport { get } from './configuration';\nimport { childrenOfNode } from './RSTTraversal';\nimport realGetAdapter from './getAdapter';\nimport validateAdapter from './validateAdapter';\n\nexport const ITERATOR_SYMBOL = typeof Symbol === 'function' && Symbol.iterator;\n\nexport function getAdapter(options = {}) {\n  console.warn('getAdapter from Utils is deprecated; please use ./getAdapter instead');\n  return realGetAdapter(options);\n}\n\nfunction validateMountOptions(attachTo, hydrateIn) {\n  if (attachTo && hydrateIn && attachTo !== hydrateIn) {\n    throw new TypeError('If both the `attachTo` and `hydrateIn` options are provided, they must be === (for backwards compatibility)');\n  }\n}\n\nexport function makeOptions(options) {\n  const { attachTo: configAttachTo, hydrateIn: configHydrateIn, ...config } = get();\n  validateMountOptions(configAttachTo, configHydrateIn);\n\n  const { attachTo, hydrateIn } = options;\n  validateMountOptions(attachTo, hydrateIn);\n\n  // neither present: both undefined\n  // only attachTo present: attachTo set, hydrateIn undefined\n  // only hydrateIn present: both set to hydrateIn\n  // both present (and ===, per above): both set to hydrateIn\n  const finalAttachTo = hydrateIn || configHydrateIn || configAttachTo || attachTo || undefined;\n  const finalHydrateIn = hydrateIn || configHydrateIn || undefined;\n  const mountTargets = {\n    ...(finalAttachTo && { attachTo: finalAttachTo }),\n    ...(finalHydrateIn && { hydrateIn: finalHydrateIn }),\n  };\n\n  return {\n    ...config,\n    ...options,\n    ...mountTargets,\n  };\n}\n\nexport function isCustomComponent(component, adapter) {\n  validateAdapter(adapter);\n  if (adapter.isCustomComponent) {\n    return !!adapter.isCustomComponent(component);\n  }\n  return typeof component === 'function';\n}\n\nexport function isCustomComponentElement(inst, adapter) {\n  if (adapter.isCustomComponentElement) {\n    return !!adapter.isCustomComponentElement(inst);\n  }\n  return !!inst && adapter.isValidElement(inst) && typeof inst.type === 'function';\n}\n\nexport function propsOfNode(node) {\n  return entries((node && node.props) || {})\n    .filter(([, value]) => typeof value !== 'undefined')\n    .reduce((acc, [key, value]) => Object.assign(acc, { [key]: value }), {});\n}\n\nexport function typeOfNode(node) {\n  return node ? node.type : null;\n}\n\nexport function nodeHasType(node, type) {\n  if (!type || !node) return false;\n\n  const adapter = realGetAdapter();\n  if (adapter.displayNameOfNode) {\n    const displayName = adapter.displayNameOfNode(node);\n    return displayName === type;\n  }\n\n  if (!node.type) return false;\n  if (typeof node.type === 'string') return node.type === type;\n  return (\n    typeof node.type === 'function' ? functionName(node.type) === type : node.type.name === type\n  ) || node.type.displayName === type;\n}\n\nfunction internalChildrenCompare(a, b, lenComp, isLoose) {\n  const nodeCompare = isLoose ? nodeMatches : nodeEqual;\n\n  if (a === b) return true;\n  if (!Array.isArray(a) && !Array.isArray(b)) {\n    return nodeCompare(a, b, lenComp);\n  }\n  const flatA = flat(a, Infinity);\n  const flatB = flat(b, Infinity);\n  if (flatA.length !== flatB.length) return false;\n  if (flatA.length === 0 && flatB.length === 0) return true;\n  for (let i = 0; i < flatA.length; i += 1) {\n    if (!nodeCompare(flatA[i], flatB[i], lenComp)) return false;\n  }\n  return true;\n}\n\nfunction childrenMatch(a, b, lenComp) {\n  return internalChildrenCompare(a, b, lenComp, true);\n}\n\nfunction childrenEqual(a, b, lenComp) {\n  return internalChildrenCompare(a, b, lenComp, false);\n}\n\nfunction removeNullaryReducer(acc, [key, value]) {\n  const addition = value == null ? {} : { [key]: value };\n  return { ...acc, ...addition };\n}\n\nfunction internalNodeCompare(a, b, lenComp, isLoose) {\n  if (a === b) return true;\n  if (!a || !b) return false;\n  if (a.type !== b.type) return false;\n\n  let left = propsOfNode(a);\n  let right = propsOfNode(b);\n  if (isLoose) {\n    left = entries(left).reduce(removeNullaryReducer, {});\n    right = entries(right).reduce(removeNullaryReducer, {});\n  }\n\n  const leftKeys = Object.keys(left);\n  for (let i = 0; i < leftKeys.length; i += 1) {\n    const prop = leftKeys[i];\n    // we will check children later\n    if (prop === 'children') {\n      // continue;\n    } else if (!(prop in right)) {\n      return false;\n    } else if (right[prop] === left[prop]) {\n      // continue;\n    } else if (typeof right[prop] === typeof left[prop] && typeof left[prop] === 'object') {\n      if (!isEqual(left[prop], right[prop])) return false;\n    } else {\n      return false;\n    }\n  }\n\n  const leftHasChildren = 'children' in left;\n  const rightHasChildren = 'children' in right;\n  const childCompare = isLoose ? childrenMatch : childrenEqual;\n  if (leftHasChildren || rightHasChildren) {\n    if (!childCompare(\n      childrenToSimplifiedArray(left.children, isLoose),\n      childrenToSimplifiedArray(right.children, isLoose),\n      lenComp,\n    )) {\n      return false;\n    }\n  }\n\n  if (!isTextualNode(a)) {\n    const rightKeys = Object.keys(right);\n    return lenComp(leftKeys.length - leftHasChildren, rightKeys.length - rightHasChildren);\n  }\n\n  return false;\n}\n\nexport function nodeMatches(a, b, lenComp = is) {\n  return internalNodeCompare(a, b, lenComp, true);\n}\n\nexport function nodeEqual(a, b, lenComp = is) {\n  return internalNodeCompare(a, b, lenComp, false);\n}\n\nexport function containsChildrenSubArray(match, node, subArray) {\n  const children = childrenOfNode(node);\n  const checker = (_, i) => arraysEqual(match, children.slice(i, i + subArray.length), subArray);\n  return children.some(checker);\n}\n\nfunction arraysEqual(match, left, right) {\n  return left.length === right.length && left.every((el, i) => match(el, right[i]));\n}\n\nfunction childrenToArray(children) {\n  const result = [];\n\n  const push = (el) => {\n    if (el === null || el === false || typeof el === 'undefined') return;\n    result.push(el);\n  };\n\n  if (Array.isArray(children)) {\n    children.forEach(push);\n  } else {\n    push(children);\n  }\n  return result;\n}\n\nexport function childrenToSimplifiedArray(nodeChildren, isLoose = false) {\n  const childrenArray = childrenToArray(nodeChildren);\n  const simplifiedArray = [];\n\n  for (let i = 0; i < childrenArray.length; i += 1) {\n    const child = childrenArray[i];\n    const previousChild = simplifiedArray.pop();\n\n    if (typeof previousChild === 'undefined') {\n      simplifiedArray.push(child);\n    } else if (isTextualNode(child) && isTextualNode(previousChild)) {\n      simplifiedArray.push(previousChild + child);\n    } else {\n      simplifiedArray.push(previousChild);\n      simplifiedArray.push(child);\n    }\n  }\n\n  if (isLoose) {\n    return simplifiedArray.map((x) => (typeof x === 'string' ? trim(x) : x));\n  }\n\n  return simplifiedArray;\n}\n\nfunction isTextualNode(node) {\n  return typeof node === 'string' || typeof node === 'number';\n}\n\nexport function isReactElementAlike(arg, adapter) {\n  return adapter.isValidElement(arg) || isTextualNode(arg) || Array.isArray(arg);\n}\n\n// TODO(lmr): can we get rid of this outside of the adapter?\nexport function withSetStateAllowed(fn) {\n  // NOTE(lmr):\n  // this is currently here to circumvent a React bug where `setState()` is\n  // not allowed without global being defined.\n  let cleanup = false;\n  if (typeof global.document === 'undefined') {\n    cleanup = true;\n    global.document = {};\n  }\n  fn();\n  if (cleanup) {\n    // This works around a bug in node/jest in that developers aren't able to\n    // delete things from global when running in a node vm.\n    global.document = undefined;\n    delete global.document;\n  }\n}\n\nexport function AND(fns) {\n  const fnsReversed = fns.slice().reverse();\n  return (x) => fnsReversed.every((fn) => fn(x));\n}\n\nexport function displayNameOfNode(node) {\n  if (!node) return null;\n\n  const { type } = node;\n\n  if (!type) return null;\n\n  return type.displayName || (typeof type === 'function' ? functionName(type) : type.name || type);\n}\n\nexport function sym(s) {\n  return typeof Symbol === 'function' ? Symbol.for(`enzyme.${s}`) : s;\n}\n\nexport function privateSet(obj, prop, value) {\n  Object.defineProperty(obj, prop, {\n    value,\n    enumerable: false,\n    writable: true,\n  });\n}\n\nexport function cloneElement(adapter, el, props) {\n  return adapter.createElement(\n    el.type,\n    { ...el.props, ...props },\n  );\n}\n\nexport function spyMethod(instance, methodName, getStub = () => {}) {\n  let lastReturnValue;\n  const originalMethod = instance[methodName];\n  const hasOwn = has(instance, methodName);\n  let descriptor;\n  if (hasOwn) {\n    descriptor = Object.getOwnPropertyDescriptor(instance, methodName);\n  }\n  Object.defineProperty(instance, methodName, {\n    configurable: true,\n    enumerable: !descriptor || !!descriptor.enumerable,\n    value: getStub(originalMethod) || function spied(...args) {\n      const result = originalMethod.apply(this, args);\n      lastReturnValue = result;\n      return result;\n    },\n  });\n  return {\n    restore() {\n      if (hasOwn) {\n        if (descriptor) {\n          Object.defineProperty(instance, methodName, descriptor);\n        } else {\n          /* eslint-disable no-param-reassign */\n          instance[methodName] = originalMethod;\n          /* eslint-enable no-param-reassign */\n        }\n      } else {\n        /* eslint-disable no-param-reassign */\n        delete instance[methodName];\n        /* eslint-enable no-param-reassign */\n      }\n    },\n    getLastReturnValue() {\n      return lastReturnValue;\n    },\n  };\n}\n\nexport { default as shallowEqual } from 'enzyme-shallow-equal';\n\nexport function isEmptyValue(renderedValue) {\n  return renderedValue === null || renderedValue === false;\n}\n\nexport function renderedDive(nodes) {\n  if (isEmptyValue(nodes)) {\n    return true;\n  }\n\n  return [].concat(nodes).every((n) => {\n    if (n) {\n      const { rendered } = n;\n      return isEmptyValue(rendered) || renderedDive(rendered);\n    }\n\n    return isEmptyValue(n);\n  });\n}\n\nexport function loadCheerioRoot(html) {\n  if (!html) {\n    return cheerio.root();\n  }\n\n  if (!isHtml(html)) {\n    // use isDocument=false to create fragment\n    return cheerio.load(html, null, false).root();\n  }\n\n  return cheerio.load('')(html);\n}\n"],"mappings":"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"}